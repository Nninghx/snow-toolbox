# 禁止生成 .pyc 文件
import sys
sys.dont_write_bytecode = True

import tkinter as tk
from tkinter import messagebox

class HelpSystem:
    """
    统一的帮助系统类，用于管理和显示所有模块的帮助内容。
    
    该类实现了以下功能：
    1. 集中管理所有模块的帮助文档
    2. 提供统一的帮助内容显示界面
    3. 自动附加统一的作者和版权信息
    4. 错误处理和默认帮助内容
    
    使用示例：
    help_system = HelpSystem()
    help_system.show_help("pdf_splitter")
    """
    # 统一的作者信息、联系方式和版权声明
    AUTHOR_INFO = """
提示：
如果发现发现Bug或需要新的功能，请联系作者：
- 作者:宁幻雪
- 联系方式:https://space.bilibili.com/556216088
- 版权:Apache-2.0 License
"""
    def __init__(self):
        self.help_contents = {
# PDF工具帮助内容合集
    # PDF拆分帮助内容
                        "PDF拆分": 
"""
PDF拆分工具使用帮助
功能说明：
- 支持PDF文件拆分功能
- 可以选择拆分的页面范围
使用步骤：
1. 点击"选择文件"选择要拆分的PDF文件,再点击"输出目录"选择好输出目录
2. 在拆分选项框中选择按页拆分还是按范围拆分
3. 点击"拆分PDF"按钮进行处理
""",
    # PDF合并帮助内容
                        "PDF合并":
"""
PDF合并工具使用帮助
功能说明：
- 支持多个PDF文件合并
使用步骤：
1. 点击"添加文件"按钮选择要合并的PDF文件，如果选择错误，点击"移除文件"按钮删除选择错误的文件
2. 选择那些哪些页面需要合并
3. 点击"合并PDF"按钮进行处理
""",
    # PDF转图片帮助内容
                        "PDF转图片":
"""
PDF转图片工具使用帮助
功能说明：
- 支持将PDF文件转换为多种图片格式
- 支持PNG/JPEG/TIFF/BMP输出格式
- 可调整DPI和质量设置
- 支持页面预览和选择
使用步骤：
1. 点击"选择PDF文件"按钮或直接将PDF文件拖放到窗口
2. 选择输出目录
3. 设置转换选项:
   - 输出格式: PNG/JPEG/TIFF/BMP
   - DPI: 控制输出图片的分辨率(72-600)
   - JPEG质量: 仅对JPEG格式有效(1-100)
4. 选择要转换的页面 - 默认转换所有页面
5. 点击"开始转换"按钮开始转换
""",

    # 图片转PDF帮助内容
                        "图片转PDF":
"""
功能说明：
可以将图片转换为PDF文件。
使用步骤：
1. 添加图片 - 点击"添加图片"按钮选择一张或多张图片
2. 选择输出PDF - 点击"选择输出PDF"按钮指定保存位置
3. 管理图片列表:
   - 右键点击图片可移除选中项
   - 点击"清空列表"可移除所有图片
4. 点击"开始转换"按钮开始转换
""",

    # PDF转Word帮助内容
                        "PDF转Word":
"""
功能说明：
可以将PDF文件转换为woed文件。
使用步骤：
1. 点击"选择PDF"按钮选择要转换的PDF文件
2. 点击"转换为Word"按钮开始转换
3. 选择保存位置和文件名
        
注意: 
- 转换时间取决于PDF文件大小
- 转换过程中请勿关闭程序
""",
    # PDF加水印帮助内容
                        "PDF加水印":
"""
PDF加水印工具使用帮助
功能说明：
- 支持为PDF文件添加文字水印
- 可自定义水印文字、大小、透明度和位置
使用步骤：
1. 点击"选择PDF"按钮选择要加水印的PDF文件
2. 设置水印选项:
   - 水印文字: 输入要显示的文字
   - 字体大小: 调整水印文字大小
   - 透明度: 调整水印透明度
   - 位置: 选择水印在页面中的位置
3. 点击"添加水印"按钮开始处理
4. 选择保存位置和文件名
""",

#图片工具帮助内容合集
    #图片九宫格分割帮助内容
                        "图片九宫格分割":
"""
功能说明
一张图片分割成九宫格
使用步骤
1. 点击"浏览..."按钮选择要分割的图片
2. 点击"浏览..."按钮选择输出目录
3. 点击"开始分割"按钮进行分割
4. 分割完成后，将在输出目录下创建一个以图片名命名的文件夹
""",

    #图片格式转换帮助内容
                        "图片格式转换":
"""
使用步骤
1. 选择转换模式:
   - 单文件模式: 转换单个图片文件
   - 批量模式: 转换整个目录中的图片
2. 设置输出格式和质量:
   - 从下拉列表中选择输出格式
   - 输入1-100的质量值(数值越大质量越好)
3. 设置输出目录:
   - 可以指定输出目录或单独选择每个文件的保存位置
4. 点击"转换"按钮开始转换
   - 批量转换时会显示进度条
   - 转换结果会显示在状态栏
""",
    #图片转图标
                        "图片转图标":
"""
使用方法：
1. 点击"浏览..."选择源图片
2. 选择标准尺寸或输入自定义尺寸
3. 点击"转换为ICO"按钮
4. 选择保存位置
""",
#其他工具帮助内容合集
#音频工具帮助内容合集
    #视频提取音频
                        "视频提取音频":
"""
使用方法：
1. 点击"浏览..."按钮选择输入视频文件
2. 点击"浏览..."按钮选择输出音频文件路径
3. 点击"开始提取"按钮执行转换
4. 确保系统已安装FFmpeg并添加到PATH环境变量
""",
#文件工具帮助内容合集
    #目录树生成器
                        "目录树生成器":
"""
使用方法:
1. 浏览按钮：点击后可以选择要分析的目录
2. 生成目录树按钮：根据所选目录生成文件结构图
3. 保存结果按钮：将当前显示的目录结构保存到文件
4. 清空按钮：清除输入框和输出区域的内容
""",


            # 其他工具帮助内容可以继续添加...
        }

    def show_help(self, module_id: str) -> None:
        try:
            # 获取格式化后的帮助内容
            help_content = self.get_help_content(module_id)
            # 显示在独立的消息框中，标题自动转换为友好格式
            messagebox.showinfo(
                f"{module_id.replace('_', ' ').title()} 帮助", 
                help_content
            )
        except Exception as e:
            # 异常处理，显示错误详情
            messagebox.showerror("错误", f"显示帮助内容时出错：{str(e)}")

    def get_help_content(self, module_id: str) -> str:
        """
        获取指定模块的帮助内容。
        
        该方法会：
        1. 检查模块ID是否存在
        2. 返回对应帮助内容并自动附加作者信息
        3. 模块不存在时返回默认帮助

        Args:
            module_id (str): 模块的唯一标识符，必须与help_contents字典键匹配

        Returns:
            str: 完整的帮助内容文本(模块帮助+作者信息)

        Raises:
            KeyError: 当指定的模块ID不存在时(内部处理，不向外抛出)
        """
        if module_id in self.help_contents:
            # 返回模块特定帮助内容并附加统一作者信息
            return self.help_contents[module_id] + self.AUTHOR_INFO
        # 模块ID不存在时返回默认帮助
        return self._get_default_help()

    def _get_default_help(self) -> str:
        return self.AUTHOR_INFO
# 创建全局帮助系统实例
help_system = HelpSystem()

def get_help_system() -> HelpSystem:
    return help_system

# 使用示例：
if __name__ == "__main__":
    # 创建测试窗口
    root = tk.Tk()
    root.title("帮助系统测试")